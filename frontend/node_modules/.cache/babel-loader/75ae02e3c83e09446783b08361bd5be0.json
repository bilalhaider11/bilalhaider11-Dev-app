{"ast":null,"code":"import _regeneratorRuntime from\"/home/aht/Desktop/MERN/client/node_modules/babel-preset-react-app/node_modules/@babel/runtime/regenerator\";import _asyncToGenerator from\"/home/aht/Desktop/MERN/client/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/asyncToGenerator\";import axios from\"axios\";import{setAlert}from'./alert';import{REGISTER_SUCCESS,REGISTER_FAIL,AUTH_ERROR,USER_LOADED,LOGIN_FAIL,LOGIN_SUCCESS,LOGOUT,CLEAR_PROFILE}from'./types';import setAuthToken from\"../utils/setAuthToken\";//load user\nexport var loadUser=function loadUser(){return/*#__PURE__*/function(){var _ref=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee(dispatch){var res;return _regeneratorRuntime.wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:if(localStorage.token){setAuthToken(localStorage.token);}_context.prev=1;_context.next=4;return axios.get('/api/auth');case 4:res=_context.sent;dispatch({type:USER_LOADED,payload:res.data});_context.next=11;break;case 8:_context.prev=8;_context.t0=_context[\"catch\"](1);dispatch({type:AUTH_ERROR});case 11:case\"end\":return _context.stop();}}},_callee,null,[[1,8]]);}));return function(_x){return _ref.apply(this,arguments);};}();};//Register user\nexport var register=function register(_ref2){var name=_ref2.name,email=_ref2.email,password=_ref2.password;return/*#__PURE__*/function(){var _ref3=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee2(dispatch){var config,body,res,errors;return _regeneratorRuntime.wrap(function _callee2$(_context2){while(1){switch(_context2.prev=_context2.next){case 0:config={headers:{'Content-Type':'application/json'}};body=JSON.stringify({name:name,email:email,password:password});_context2.prev=2;_context2.next=5;return axios.post('/api/users',body,config);case 5:res=_context2.sent;dispatch({type:REGISTER_SUCCESS,payload:res.data});dispatch(loadUser());_context2.next=15;break;case 10:_context2.prev=10;_context2.t0=_context2[\"catch\"](2);errors=_context2.t0.response.data.errors;if(errors){errors.forEach(function(error){return dispatch(setAlert(error.msg,'danger'));});}dispatch({type:REGISTER_FAIL});case 15:case\"end\":return _context2.stop();}}},_callee2,null,[[2,10]]);}));return function(_x2){return _ref3.apply(this,arguments);};}();};//Login user\nexport var login=function login(email,password){return/*#__PURE__*/function(){var _ref4=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee3(dispatch){var config,body,res,errors;return _regeneratorRuntime.wrap(function _callee3$(_context3){while(1){switch(_context3.prev=_context3.next){case 0:config={headers:{'Content-Type':'application/json'}};body=JSON.stringify({email:email,password:password});_context3.prev=2;_context3.next=5;return axios.post('/api/auth',body,config);case 5:res=_context3.sent;dispatch({type:LOGIN_SUCCESS,payload:res.data});dispatch(loadUser());_context3.next=15;break;case 10:_context3.prev=10;_context3.t0=_context3[\"catch\"](2);errors=_context3.t0.response.data.errors;if(errors){errors.forEach(function(error){return dispatch(setAlert(error.msg,'danger'));});}dispatch({type:LOGIN_FAIL});case 15:case\"end\":return _context3.stop();}}},_callee3,null,[[2,10]]);}));return function(_x3){return _ref4.apply(this,arguments);};}();};//Logout / clear Profile\nexport var logout=function logout(){return function(dispatch){dispatch({type:CLEAR_PROFILE});dispatch({type:LOGOUT});};};","map":{"version":3,"sources":["/home/aht/Desktop/MERN/client/src/actions/auth.js"],"names":["axios","setAlert","REGISTER_SUCCESS","REGISTER_FAIL","AUTH_ERROR","USER_LOADED","LOGIN_FAIL","LOGIN_SUCCESS","LOGOUT","CLEAR_PROFILE","setAuthToken","loadUser","dispatch","localStorage","token","get","res","type","payload","data","register","name","email","password","config","headers","body","JSON","stringify","post","errors","response","forEach","error","msg","login","logout"],"mappings":"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","sourcesContent":["import axios from \"axios\";\n\nimport {setAlert} from './alert';\nimport {\n    REGISTER_SUCCESS, \n    REGISTER_FAIL, \n    AUTH_ERROR, \n    USER_LOADED,\n    LOGIN_FAIL,\n    LOGIN_SUCCESS,\n    LOGOUT,\n    CLEAR_PROFILE\n} from './types';\nimport setAuthToken from \"../utils/setAuthToken\";\n\n//load user\nexport const loadUser = () => async dispatch => { \n    if(localStorage.token){\n        setAuthToken(localStorage.token)\n    }\n\n    try{\n        const res = await axios.get('/api/auth');\n\n        dispatch({\n            type: USER_LOADED,\n            payload: res.data\n        })\n    }\n    catch(err) {\n        dispatch({type: AUTH_ERROR});\n    }\n}\n\n//Register user\nexport const register = ({name, email, password}) => async dispatch => {\n    const config = {\n        headers: {\n            'Content-Type': 'application/json'\n        }\n    }\n\n    const body = JSON.stringify({name, email, password});\n    try{\n        const res = await axios.post('/api/users', body, config);\n        \n        dispatch({\n            type: REGISTER_SUCCESS,\n            payload: res.data\n        });\n\n        dispatch(loadUser());\n    }\n    catch(err) {\n        const errors = err.response.data.errors;\n\n        if(errors) {\n            errors.forEach(error => dispatch(setAlert(error.msg, 'danger')));\n        }\n        dispatch({\n            type: REGISTER_FAIL \n        })\n    }\n};\n\n\n//Login user\nexport const login = ( email, password) => async dispatch => {\n    const config = {\n        headers: {\n            'Content-Type': 'application/json'\n        }\n    }\n\n    const body = JSON.stringify({email, password});\n    try{\n        const res = await axios.post('/api/auth', body, config);\n        \n        dispatch({\n            type: LOGIN_SUCCESS,\n            payload: res.data\n        });\n\n        dispatch(loadUser());\n    }\n    catch(err) {\n        const errors = err.response.data.errors;\n\n        if(errors) {\n            errors.forEach(error => dispatch(setAlert(error.msg, 'danger')));\n        }\n        dispatch({\n            type: LOGIN_FAIL \n        })\n    }\n};\n\n//Logout / clear Profile\n\nexport const logout = () => dispatch => {\n    dispatch({type: CLEAR_PROFILE});\n    dispatch({type: LOGOUT});\n};"]},"metadata":{},"sourceType":"module"}